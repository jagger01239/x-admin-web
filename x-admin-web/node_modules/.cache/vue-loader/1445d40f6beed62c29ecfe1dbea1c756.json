{"remainingRequest":"D:\\ZJNU\\SoftwareProject\\x-admin-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\ZJNU\\SoftwareProject\\x-admin-web\\src\\views\\sys\\role.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\ZJNU\\SoftwareProject\\x-admin-web\\src\\views\\sys\\role.vue","mtime":1701656784233},{"path":"D:\\ZJNU\\SoftwareProject\\x-admin-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\ZJNU\\SoftwareProject\\x-admin-web\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\ZJNU\\SoftwareProject\\x-admin-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\ZJNU\\SoftwareProject\\x-admin-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCByb2xlQXBpIGZyb20gJ0AvYXBpL3JvbGVNYW5hZ2UnCmltcG9ydCBtZW51QXBpIGZyb20gJ0AvYXBpL21lbnVNYW5hZ2UnCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCl7CiAgICByZXR1cm57CiAgICAgIG1lbnVMaXN0OiBbXSwKICAgICAgbWVudVByb3BzOiB7CiAgICAgICAgY2hpbGRyZW46ICdjaGlsZHJlbicsCiAgICAgICAgbGFiZWw6ICd0aXRsZScKICAgICAgfSwKICAgICAgZm9ybUxhYmVsV2lkdGg6ICcxMzBweCcsCiAgICAgIHJvbGVGb3JtOiB7fSwKICAgICAgZGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLAogICAgICB0aXRsZTogJycsCiAgICAgIHNlYXJjaE1vZGVsOiB7CiAgICAgICAgcGFnZU5vOiAxLAogICAgICAgIHBhZ2VTaXplOiAxMAogICAgICB9LAogICAgICByb2xlTGlzdDogW10sCiAgICAgIHRvdGFsOiAwLAogICAgICBydWxlczp7CiAgICAgICAgcm9sZU5hbWU6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXop5LoibLlkI3np7AnLCB0cmlnZ2VyOiAnYmx1cicgfSwKICAgICAgICAgIHsgbWluOiAzLCBtYXg6IDUwLCBtZXNzYWdlOiAn6ZW/5bqm5ZyoIDMg5YiwIDUwIOS4quWtl+espicsIHRyaWdnZXI6ICdibHVyJyB9CiAgICAgICAgXQogICAgICB9CiAgICB9CiAgfSwKICBtZXRob2RzOnsKICAgIGRlbGV0ZVJvbGUocm9sZSl7CiAgICAgIHRoaXMuJGNvbmZpcm0oYOaCqOehruWumuWIoOmZpOinkuiJsiAke3JvbGUucm9sZU5hbWV9IO+8n2AsICfmj5DnpLonLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICByb2xlQXBpLmRlbGV0ZVJvbGVCeUlkKHJvbGUucm9sZUlkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgIG1lc3NhZ2U6IHJlc3BvbnNlLm1lc3NhZ2UKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgdGhpcy5nZXRSb2xlTGlzdCgpOwogICAgICAgIH0pOwoKICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ2luZm8nLAogICAgICAgICAgbWVzc2FnZTogJ+W3suWPlua2iOWIoOmZpCcKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgc2F2ZVJvbGUoKXsKICAgICAgbGV0IHNlbGVjdGVkID0gdGhpcy4kcmVmcy5tZW51UmVmLmdldENoZWNrZWRLZXlzKCk7CiAgICAgIGxldCBoYWxmU2VsZWN0ZWQgPSB0aGlzLiRyZWZzLm1lbnVSZWYuZ2V0SGFsZkNoZWNrZWRLZXlzKCk7CiAgICAgIHRoaXMucm9sZUZvcm0ubWVudUlkTGlzdCA9IHNlbGVjdGVkLmNvbmNhdChoYWxmU2VsZWN0ZWQpOwoKICAgICAgY29uc29sZS5sb2codGhpcy5yb2xlRm9ybS5tZW51SWRMaXN0KQoKICAgICAgLy8g6Kem5Y+R6KGo5Y2V6aqM6K+BCiAgICAgIHRoaXMuJHJlZnMucm9sZUZvcm1SZWYudmFsaWRhdGUoKHZhbGlkKSA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICAvLyDmj5DkuqTkv53lrZjor7fmsYIKICAgICAgICAgIHJvbGVBcGkuc2F2ZVJvbGUodGhpcy5yb2xlRm9ybSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgIC8vIOaIkOWKn+aPkOekugogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICBtZXNzYWdlOiByZXNwb25zZS5tZXNzYWdlLAogICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgLy8g5YWz6Zet5a+56K+d5qGGCiAgICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgLy8g5Yi35paw6KGo5qC85pWw5o2uCiAgICAgICAgICAgIHRoaXMuZ2V0Um9sZUxpc3QoKTsKICAgICAgICAgIH0pOwoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yIHN1Ym1pdCEhJyk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKCiAgICB9LAogICAgY2xlYXJGb3JtKCl7CiAgICAgIHRoaXMucm9sZUZvcm0gPSB7fTsKICAgICAgdGhpcy4kcmVmcy5yb2xlRm9ybVJlZi5jbGVhclZhbGlkYXRlKCk7CiAgICAgIHRoaXMuJHJlZnMubWVudVJlZi5zZXRDaGVja2VkS2V5cyhbXSkKICAgIH0sCiAgICBvcGVuRWRpdFVJKGlkKXsKICAgICAgaWYoaWQgPT0gbnVsbCl7CiAgICAgICAgdGhpcy50aXRsZSA9ICfmlrDlop7op5LoibInOwogICAgICB9ZWxzZXsKICAgICAgICB0aGlzLnRpdGxlID0gJ+S/ruaUueinkuiJsic7CiAgICAgICAgcm9sZUFwaS5nZXRSb2xlQnlJZChpZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICB0aGlzLnJvbGVGb3JtID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgIHRoaXMuJHJlZnMubWVudVJlZi5zZXRDaGVja2VkS2V5cyhyZXNwb25zZS5kYXRhLm1lbnVJZExpc3QpOwogICAgICAgIH0pOwogICAgICB9CiAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSB0cnVlOwogICAgfSwKICAgIGhhbmRsZVNpemVDaGFuZ2UocGFnZVNpemUpewogICAgICB0aGlzLnNlYXJjaE1vZGVsLnBhZ2VTaXplID0gcGFnZVNpemU7CiAgICAgIHRoaXMuZ2V0Um9sZUxpc3QoKTsKICAgIH0sCiAgICBoYW5kbGVDdXJyZW50Q2hhbmdlKHBhZ2VObyl7CiAgICAgIHRoaXMuc2VhcmNoTW9kZWwucGFnZU5vID0gcGFnZU5vOwogICAgICB0aGlzLmdldFJvbGVMaXN0KCk7CiAgICB9LAogICAgZ2V0Um9sZUxpc3QoKXsKICAgICAgcm9sZUFwaS5nZXRSb2xlTGlzdCh0aGlzLnNlYXJjaE1vZGVsKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLnJvbGVMaXN0ID0gcmVzcG9uc2UuZGF0YS5yb3dzOwogICAgICAgIHRoaXMudG90YWwgPSByZXNwb25zZS5kYXRhLnRvdGFsOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRBbGxNZW51KCl7CiAgICAgICAgbWVudUFwaS5nZXRBbGxNZW51KCkudGhlbihyZXMgPT57CiAgICAgICAgICB0aGlzLm1lbnVMaXN0ID0gcmVzLmRhdGE7CiAgICAgICAgfSkKICAgIH0KICB9LAogIGNyZWF0ZWQoKXsKICAgIHRoaXMuZ2V0Um9sZUxpc3QoKTsKICAgIHRoaXMuZ2V0QWxsTWVudSgpOwogIH0KfTsK"},{"version":3,"sources":["role.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"role.vue","sourceRoot":"src/views/sys","sourcesContent":["<template>\n  <div>\n    <!-- 搜索栏 -->\n    <el-card id=\"search\">\n      <el-row>\n        <el-col :span=\"18\">\n          <el-input placeholder=\"角色名\" v-model=\"searchModel.roleName\" clearable> </el-input>\n          <el-button @click=\"getRoleList\" type=\"primary\" icon=\"el-icon-search\" round>查询</el-button>\n        </el-col>\n        <el-col :span=\"6\" align=\"right\">\n          <el-button @click=\"openEditUI(null)\" type=\"primary\" icon=\"el-icon-plus\" circle></el-button>\n        </el-col>\n      </el-row>\n    </el-card>\n\n    <!-- 结果列表 -->\n    <el-card>\n      <el-table :data=\"roleList\" stripe style=\"width: 100%\">\n        <el-table-column label=\"#\" width=\"80\">\n          <template slot-scope=\"scope\">\n            {{(searchModel.pageNo-1) * searchModel.pageSize + scope.$index + 1}}\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"roleId\" label=\"角色编号\" width=\"180\">\n        </el-table-column>\n        <el-table-column prop=\"roleName\" label=\"角色名称\" width=\"180\">\n        </el-table-column>\n        <el-table-column prop=\"roleDesc\" label=\"角色描述\" >\n        </el-table-column>\n        <el-table-column   label=\"操作\" width=\"180\">\n          <template slot-scope=\"scope\">\n            <el-button @click=\"openEditUI(scope.row.roleId)\" type=\"primary\" icon=\"el-icon-edit\" circle size=\"mini\"></el-button>\n            <el-button @click=\"deleteRole(scope.row)\" type=\"danger\" icon=\"el-icon-delete\" circle size=\"mini\"></el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-card>\n    <el-pagination\n      @size-change=\"handleSizeChange\"\n      @current-change=\"handleCurrentChange\"\n      :current-page=\"searchModel.pageNo\"\n      :page-sizes=\"[5, 10, 20, 50]\"\n      :page-size=\"searchModel.pageSize\"\n      layout=\"total, sizes, prev, pager, next, jumper\"\n      :total=\"total\">\n    </el-pagination>\n\n    <!-- 对话框 -->\n    <el-dialog @close=\"clearForm\" :title=\"title\" :visible.sync=\"dialogFormVisible\" :close-on-click-modal=\"false\">\n      <el-form :model=\"roleForm\" ref=\"roleFormRef\" :rules=\"rules\">\n        <el-form-item prop=\"roleName\" label=\"角色名称\" :label-width=\"formLabelWidth\">\n          <el-input v-model=\"roleForm.roleName\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n\n        <el-form-item prop=\"roleDesc\" label=\"角色描述\" :label-width=\"formLabelWidth\">\n          <el-input v-model=\"roleForm.roleDesc\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n\n        <el-form-item\n          prop=\"menuIdList\"\n          label=\"权限设置\"\n          :label-width=\"formLabelWidth\"\n        >\n          <el-tree\n            ref=\"menuRef\"\n            :data=\"menuList\"\n            :props=\"menuProps\"\n            node-key=\"menuId\"\n            show-checkbox\n            style=\"width:85%\"\n            default-expand-all\n          ></el-tree>\n        </el-form-item>\n\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"saveRole\">确 定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n\n<script>\nimport roleApi from '@/api/roleManage'\nimport menuApi from '@/api/menuManage'\nexport default {\n  data(){\n    return{\n      menuList: [],\n      menuProps: {\n        children: 'children',\n        label: 'title'\n      },\n      formLabelWidth: '130px',\n      roleForm: {},\n      dialogFormVisible: false,\n      title: '',\n      searchModel: {\n        pageNo: 1,\n        pageSize: 10\n      },\n      roleList: [],\n      total: 0,\n      rules:{\n        roleName: [\n          { required: true, message: '请输入角色名称', trigger: 'blur' },\n          { min: 3, max: 50, message: '长度在 3 到 50 个字符', trigger: 'blur' }\n        ]\n      }\n    }\n  },\n  methods:{\n    deleteRole(role){\n      this.$confirm(`您确定删除角色 ${role.roleName} ？`, '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        roleApi.deleteRoleById(role.roleId).then(response => {\n          this.$message({\n            type: 'success',\n            message: response.message\n          });\n          this.dialogFormVisible = false;\n          this.getRoleList();\n        });\n\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n    saveRole(){\n      let selected = this.$refs.menuRef.getCheckedKeys();\n      let halfSelected = this.$refs.menuRef.getHalfCheckedKeys();\n      this.roleForm.menuIdList = selected.concat(halfSelected);\n\n      console.log(this.roleForm.menuIdList)\n\n      // 触发表单验证\n      this.$refs.roleFormRef.validate((valid) => {\n        if (valid) {\n          // 提交保存请求\n          roleApi.saveRole(this.roleForm).then(response => {\n            // 成功提示\n            this.$message({\n              message: response.message,\n              type: 'success'\n            });\n            // 关闭对话框\n            this.dialogFormVisible = false;\n            // 刷新表格数据\n            this.getRoleList();\n          });\n\n        } else {\n          console.log('error submit!!');\n          return false;\n        }\n      });\n\n    },\n    clearForm(){\n      this.roleForm = {};\n      this.$refs.roleFormRef.clearValidate();\n      this.$refs.menuRef.setCheckedKeys([])\n    },\n    openEditUI(id){\n      if(id == null){\n        this.title = '新增角色';\n      }else{\n        this.title = '修改角色';\n        roleApi.getRoleById(id).then(response => {\n          this.roleForm = response.data;\n          this.$refs.menuRef.setCheckedKeys(response.data.menuIdList);\n        });\n      }\n      this.dialogFormVisible = true;\n    },\n    handleSizeChange(pageSize){\n      this.searchModel.pageSize = pageSize;\n      this.getRoleList();\n    },\n    handleCurrentChange(pageNo){\n      this.searchModel.pageNo = pageNo;\n      this.getRoleList();\n    },\n    getRoleList(){\n      roleApi.getRoleList(this.searchModel).then(response => {\n        this.roleList = response.data.rows;\n        this.total = response.data.total;\n      });\n    },\n    getAllMenu(){\n        menuApi.getAllMenu().then(res =>{\n          this.menuList = res.data;\n        })\n    }\n  },\n  created(){\n    this.getRoleList();\n    this.getAllMenu();\n  }\n};\n</script>\n\n<style>\n#search .el-input {\n  width: 200px;\n  margin-right: 10px;\n}\n.el-dialog .el-input{\n  width: 85%;\n}\n</style>\n"]}]}