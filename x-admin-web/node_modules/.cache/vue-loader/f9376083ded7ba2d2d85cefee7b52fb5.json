{"remainingRequest":"D:\\ZJNU\\SoftwareProject\\x-admin-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\ZJNU\\SoftwareProject\\x-admin-web\\src\\views\\sys\\user.vue?vue&type=style&index=0&id=368d7532&lang=css&","dependencies":[{"path":"D:\\ZJNU\\SoftwareProject\\x-admin-web\\src\\views\\sys\\user.vue","mtime":1701656784217},{"path":"D:\\ZJNU\\SoftwareProject\\x-admin-web\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\ZJNU\\SoftwareProject\\x-admin-web\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\ZJNU\\SoftwareProject\\x-admin-web\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\ZJNU\\SoftwareProject\\x-admin-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\ZJNU\\SoftwareProject\\x-admin-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCiNzZWFyY2ggLmVsLWlucHV0IHsKICB3aWR0aDogMjAwcHg7CiAgbWFyZ2luLXJpZ2h0OiAxMHB4Owp9Ci5lbC1kaWFsb2cgLmVsLWlucHV0IHsKICB3aWR0aDogODUlOwp9Cg=="},{"version":3,"sources":["user.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+TA;AACA;AACA;AACA;AACA;AACA;AACA","file":"user.vue","sourceRoot":"src/views/sys","sourcesContent":["<template>\n  <div>\n    <!-- 搜索栏 -->\n    <el-card id=\"search\">\n      <el-row>\n        <el-col :span=\"20\">\n          <el-input\n            v-model=\"searchModel.username\"\n            placeholder=\"用户名\"\n            clearable\n          ></el-input>\n          <el-input\n            v-model=\"searchModel.phone\"\n            placeholder=\"电话\"\n            clearable\n          ></el-input>\n          <el-button\n            @click=\"getUserList\"\n            type=\"primary\"\n            round\n            icon=\"el-icon-search\"\n            >查询</el-button\n          >\n          <el-button\n            @click=\"ExportUserlist\"\n            type=\"success\"\n            round\n            icon=\"el-icon-upload2\"\n          >导出</el-button\n          >\n          <el-upload style=\"display: inline-block; margin-left: 10px\"\n            action=\"http://localhost:9999/import\"\n            :show-file-list=\"false\"\n            :accept=\"'xlsx'\"\n            :on-success=\"handleImportSuccess\"\n          >\n          <el-button\n            type=\"warning\"\n            round\n            icon=\"el-icon-download\"\n          >导入</el-button>\n          </el-upload>\n        </el-col>\n        <el-col :span=\"4\" align=\"right\">\n          <el-button\n            @click=\"openEditUI(null)\"\n            type=\"primary\"\n            icon=\"el-icon-plus\"\n            circle\n          ></el-button>\n        </el-col>\n      </el-row>\n    </el-card>\n\n    <!-- 结果列表 -->\n    <el-card>\n      <el-table :data=\"userList\" stripe style=\"width: 100%\">\n        <el-table-column label=\"#\" width=\"80\">\n          <template slot-scope=\"scope\">\n            <!-- (pageNo-1) * pageSize + index + 1 -->\n            {{\n              (searchModel.pageNo - 1) * searchModel.pageSize + scope.$index + 1\n            }}\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"id\" label=\"用户ID\" width=\"180\">\n        </el-table-column>\n        <el-table-column prop=\"username\" label=\"用户名\" width=\"180\">\n        </el-table-column>\n        <el-table-column prop=\"phone\" label=\"电话\" width=\"180\">\n        </el-table-column>\n        <el-table-column prop=\"status\" label=\"用户状态\" width=\"180\">\n          <template slot-scope=\"scope\">\n            <el-tag v-if=\"scope.row.status == 1\">正常</el-tag>\n            <el-tag v-else type=\"danger\">禁用</el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"email\" label=\"电子邮件\"> </el-table-column>\n        <el-table-column label=\"操作\" width=\"180\">\n          <template slot-scope=\"scope\">\n            <el-button @click=\"openEditUI(scope.row.id)\" type=\"primary\" icon=\"el-icon-edit\" size=\"mini\" circle></el-button>\n            <el-button @click=\"deleteUser(scope.row)\" type=\"danger\" icon=\"el-icon-delete\" size=\"mini\" circle></el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-card>\n\n    <!-- 分页组件 -->\n    <el-pagination\n      @size-change=\"handleSizeChange\"\n      @current-change=\"handleCurrentChange\"\n      :current-page=\"searchModel.pageNo\"\n      :page-sizes=\"[5, 10, 20, 50]\"\n      :page-size=\"searchModel.pageSize\"\n      layout=\"total, sizes, prev, pager, next, jumper\"\n      :total=\"total\"\n    >\n    </el-pagination>\n\n    <!-- 用户信息编辑对话框 -->\n    <el-dialog\n      @close=\"clearForm\"\n      :title=\"title\"\n      :visible.sync=\"dialogFormVisible\"\n    >\n      <el-form :model=\"userForm\" ref=\"userFormRef\" :rules=\"rules\">\n        <el-form-item\n          label=\"用户名\"\n          prop=\"username\"\n          :label-width=\"formLabelWidth\"\n        >\n          <el-input v-model=\"userForm.username\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item v-if=\"userForm.id == null || userForm.id == undefined\"\n          label=\"登录密码\"\n          prop=\"password\"\n          :label-width=\"formLabelWidth\"\n        >\n          <el-input\n            type=\"password\"\n            v-model=\"userForm.password\"\n            autocomplete=\"off\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item label=\"联系电话\" :label-width=\"formLabelWidth\">\n          <el-input v-model=\"userForm.phone\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"用户状态\" :label-width=\"formLabelWidth\">\n          <el-switch\n            v-model=\"userForm.status\"\n            :active-value=\"1\"\n            :inactive-value=\"0\"\n          >\n          </el-switch>\n        </el-form-item>\n        <el-form-item label=\"用户角色\" :label-width=\"formLabelWidth\">\n          <el-checkbox-group\n            style=\"width: 85%;\"\n            v-model=\"userForm.roleIdList\"\n            :min=\"1\"\n            :max=\"2\">\n            <el-checkbox v-for=\"(role) in roleList\" :label=\"role.roleId\" :key=\"role.roleId\">{{role.roleDesc}}</el-checkbox>\n          </el-checkbox-group>\n        </el-form-item>\n\n        <el-form-item\n          label=\"电子邮件\"\n          prop=\"email\"\n          :label-width=\"formLabelWidth\"\n        >\n          <el-input v-model=\"userForm.email\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"saveUser\">确 定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport userApi from \"@/api/userManage\";\nimport request from \"@/utils/request\";\nimport roleApi from \"@/api/roleManage\"\nexport default {\n  data() {\n    var checkEmail = (rule, value, callback) => {\n      var reg =\n        /^[a-zA-Z0-9]+([-_.][a-zA-Z0-9]+)*@[a-zA-Z0-9]+([-_.][a-zA-Z0-9]+)*\\.[a-z]{2,}$/;\n      if (!reg.test(value)) {\n        return callback(new Error(\"邮箱格式错误\"));\n      }\n      callback();\n\n    };\n    return {\n      roleList: [],\n      formLabelWidth: \"130px\",\n      userForm: {\n        roleIdList: []\n      },\n      dialogFormVisible: false,\n      title: \"\",\n      total: 0,\n      searchModel: {\n        pageNo: 1,\n        pageSize: 10,\n      },\n      userList: [],\n      rules: {\n        username: [\n          { required: true, message: \"请输入用户名\", trigger: \"blur\" },\n          {\n            min: 3,\n            max: 50,\n            message: '长度在 3 到 50 个字符',\n            trigger: \"blur\",\n          },\n        ],\n        password: [\n          { required: true, message: \"请输入登录初始密码\", trigger: \"blur\" },\n          {\n            min: 6,\n            max: 16,\n            message: \"长度在 6 到 16 个字符\",\n            trigger: \"blur\",\n          },\n        ],\n        email: [\n          { required: true, message: \"请输入电子邮件\", trigger: \"blur\" },\n          { validator: checkEmail, trigger: \"blur\" },\n        ],\n      },\n    };\n  },\n  methods: {\n    ExportUserlist() {\n      window.open(\"http://localhost:9999/export\")\n    },\n    handleImportSuccess(){\n      this.$message({\n        type: 'success',\n        message: \"导入成功啦！\"\n      })\n      this.getUserList();\n    },\n    deleteUser(user){\n      this.$confirm(`您确认删除用户 ${user.username} ?`, '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          userApi.deleteUserById(user.id).then(response => {\n            this.$message({\n              type: 'success',\n              message: response.message\n            });\n            this.getUserList();\n          });\n\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消删除'\n          });\n        });\n    },\n    saveUser() {\n      // 触发表单验证\n      this.$refs.userFormRef.validate((valid) => {\n        if (valid) {\n          // 提交请求给后台\n          userApi.saveUser(this.userForm).then(response => {\n            // 成功提示\n            this.$message({\n              message: response.message,\n              type: 'success'\n            });\n            // 关闭对话框\n            this.dialogFormVisible = false;\n            // 刷新表格\n            this.getUserList();\n          });\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n\n    },\n    clearForm() {\n      this.userForm = {\n        roleIdList: []\n      };\n      this.$refs.userFormRef.clearValidate();\n    },\n    openEditUI(id) {\n      if( id == null){\n        this.title = \"新增用户\";\n      }else{\n        this.title = \"修改用户\";\n        // 根据id查询用户数据\n        userApi.getUserById(id).then(response => {\n\n          this.userForm = response.data;\n        });\n      }\n      this.dialogFormVisible = true;\n    },\n    handleSizeChange(pageSize) {\n      this.searchModel.pageSize = pageSize;\n      this.getUserList();\n    },\n    handleCurrentChange(pageNo) {\n      this.searchModel.pageNo = pageNo;\n      this.getUserList();\n    },\n    getUserList() {\n      userApi.getUserList(this.searchModel).then((response) => {\n        this.userList = response.data.rows;\n        this.total = response.data.total;\n      });\n    },\n    getRoleList(){\n      roleApi.getAllRole().then(res =>{\n        this.roleList = res.data;\n        console.log(res.data);\n      })\n    }\n  },\n  created() {\n    this.getUserList();\n    this.getRoleList();\n  },\n};\n</script>\n\n<style>\n#search .el-input {\n  width: 200px;\n  margin-right: 10px;\n}\n.el-dialog .el-input {\n  width: 85%;\n}\n</style>\n"]}]}